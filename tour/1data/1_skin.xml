<?xml version="1.0" encoding="UTF-8"?>
<krpano version="1.19-pr16">

    
  <!-- Spot Style - Default Point Spot Style -->


  <style name="IconDefaultPointSpotStyle"
         url="%FIRSTXML%/spots/hotspot_user_defaultpoint0.png"
         visible="false"
         edge="center"
         onhover="onhoverIconDefaultPointSpotStyle"
         onout="onoutIconDefaultPointSpotStyle"


         />
  <action name="onhoverIconDefaultPointSpotStyle">
    showtooltip('hotspot');
  </action>
  <action name="onoutIconDefaultPointSpotStyle">
    hideTooltip();



  </action>



<!-- ********** -->
<!-- D-pad Control Bar -->
<!-- id : controlBar_dpad -->
<!-- ********** -->

<krpano controlBar_dpadbarbuilt="false" controlBar_dpadhorizontalwidth="0" controlBar_dpadverticalheight="0" controlBar_dpadIsOpened="false" />

<events name="controlBar_dpadevents" 
	onxmlcomplete="controlBar_dpadbuildMenuBar();" 

	openvideointerface="controlBar_dpadOpenVideoplayer();" 
	closevideointerface="controlBar_dpadCloseVideoplayer();" 

	keep="true" />



<action name="controlBar_dpadbuildMenuBar">
	ifnot (controlBar_dpadbarbuilt, controlBar_dpadbuildMenu(); set(controlBar_dpadbarbuilt, true););
</action>

<action name="controlBar_dpadbuildMenu">
	
	
	
	set(controlBar_dpadbutton_pos, 10);


	if(plugin[ptpvrmode] AND device.html5,
		set(layer[controlBar_dpadbtn_enter_vr].y, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadbtn_enter_vr_not].y, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);
	);


		if (device.fullscreensupport,
			set(layer[controlBar_dpadbtn_openfs].y, get(controlBar_dpadbutton_pos));
			set(layer[controlBar_dpadbtn_closefs].y, get(controlBar_dpadbutton_pos));
			inc(controlBar_dpadbutton_pos, 40);
		);
	
		if (device.desktop,
			set(layer[controlBar_dpadbtn_ctrlmode_drag_to].y, get(controlBar_dpadbutton_pos));
			set(layer[controlBar_dpadbtn_ctrlmode_move_to].y, get(controlBar_dpadbutton_pos));
			inc(controlBar_dpadbutton_pos, 40);
		);
	


	
		if (device.desktop,
			set(layer[controlBar_dpadbtn_out].y, get(controlBar_dpadbutton_pos));
			inc(controlBar_dpadbutton_pos, 40);
				set(layer[controlBar_dpadzoom_slider_bg].y, get(controlBar_dpadbutton_pos));
				inc(controlBar_dpadbutton_pos, 70);
			set(layer[controlBar_dpadbtn_in].y, get(controlBar_dpadbutton_pos));
			inc(controlBar_dpadbutton_pos, 40);
		);
	
		set(layer[controlBar_dpadbtn_autorotate_on ].y, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadbtn_autorotate_off].y, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);
	

		set(layer[controlBar_dpadbtn_autotour_on ].y, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadbtn_autotour_off].y, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);
	
		set(layer[controlBar_dpadbtn_play_video].y, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadbtn_pause_video].y, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);

	
	if (controlBar_dpadbutton_pos != 10,
		set(layer[controlBar_dpadmenu_vertical_bg].height, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadmenu_vertical_bg_border].height, get(controlBar_dpadbutton_pos));
		set(controlBar_dpadverticalheight, get(controlBar_dpadbutton_pos));

		sub(controlBar_dpadverticalheightwithoutvideo, controlBar_dpadverticalheight, 30);
		sub(controlBar_dpadverticalheightwithoutvideo, 10);
		if(controlBar_dpadverticalheightwithoutvideo == 10,
			set(controlBar_dpadverticalheightwithoutvideo, 0);
		);

	,
		set(layer[controlBar_dpadmenu_vertical_bg].height, 0);
		set(layer[controlBar_dpadmenu_vertical_bg_border].height, 0);

		set(controlBar_dpadverticalheightwithoutvideo, 0);

	);
	
	
	
	set(controlBar_dpadbutton_pos, 10);
	
		set(layer[controlBar_dpadbtn_home].x, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);
	
		if (scene.count GT 1,
			set(layer[controlBar_dpadbtn_prev_pano].x, get(controlBar_dpadbutton_pos));
			inc(controlBar_dpadbutton_pos, 40);
			
			set(layer[controlBar_dpadbtn_next_pano].x, get(controlBar_dpadbutton_pos));
			inc(controlBar_dpadbutton_pos, 40);
		);
	


	
		set(layer[controlBar_dpadbtn_show_thumbnails].x, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadbtn_hide_thumbnails].x, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);
	
		set(layer[controlBar_dpadbtn_show_hotspots].x, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadbtn_hide_hotspots].x, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);
	

	
	
	
		set(layer[controlBar_dpadbtn_display_info].x, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadbtn_close_info].x, get(controlBar_dpadbutton_pos));
		inc(controlBar_dpadbutton_pos, 40);

	
	
	if (controlBar_dpadbutton_pos != 10,
		set(layer[controlBar_dpadmenu_horizontal_bg].width, get(controlBar_dpadbutton_pos));
		set(layer[controlBar_dpadmenu_horizontal_bg_border].width, get(controlBar_dpadbutton_pos));
		set(controlBar_dpadhorizontalwidth, get(controlBar_dpadbutton_pos));
	,
		set(layer[controlBar_dpadmenu_horizontal_bg].width, 0);
	);
	
	
	
	
</action>


<events name="controlBar_dpadStartTourEvents" onTourStart="controlBar_dpadCallOnStartTour();" keep="true" />

<action name="controlBar_dpadCallOnStartTour">
	
	controlBar_dpadshowMenuControls();
</action>

	<action name="controlBar_dpadOpenVideoplayer">
		set(controlBar_dpad_use_videoplayer_interface, true);
		
		controlBar_dpadupdateHideShowVideoplayerButtons();
	</action>
	<action name="controlBar_dpadCloseVideoplayer">
		set(controlBar_dpad_use_videoplayer_interface, false);
		
		controlBar_dpadupdateHideShowVideoplayerButtons();
	</action>



<style name="controlBar_dpadbtn_vertical_style"
	keep="true"
	align="bottom"
	onhover="controlBar_dpadshowVerticalMenuTooltip();"
	onout="hideTooltip();"
	crop="0|0|30|30"
	onovercrop="0|30|30|30"
	ondowncrop="0|60|30|30"
	x="0"
	/>
<style name="controlBar_dpadbtn_vertical_style_off"
	keep="true"
	align="bottom"
	onhover="controlBar_dpadshowVerticalMenuTooltip();"
	onout="hideTooltip();"
	x="0"
	/>
<style name="controlBar_dpadbtn_vertical_style_alpha"
	alpha="1.0"
	devices="tablet.or.mobile"
	/>
<style name="controlBar_dpadbtn_vertical_style_alpha"
	alpha="0.2"
	devices="desktop"
	/>

<style name="controlBar_dpadmenu_bg_alpha"
	alpha="0.2"
	devices="desktop"
	/>
<style name="controlBar_dpadmenu_bg_alpha"
	alpha="0.5"
	devices="tablet.or.mobile"
	/>

<layer name="controlBar_dpadmenu_vertical_bg"
	url="%FIRSTXML%/graphics/crosscornerbar/btn_bg_vertical.png"
	keep="true"
	align="bottomleft"
	x="64"
	y="118"
	edge="bottom"
	zorder="1"
	scale9grid="12|10|3|40"
	style="controlBar_dpadmenu_bg_alpha"
	visible="false"
	/>

<layer name="controlBar_dpadmenu_vertical_bg_border"
	url="%FIRSTXML%/graphics/crosscornerbar/btn_bg_border_vertical.png"
	keep="true"
	align="bottomleft"
	x="64"
	y="118"
	edge="bottom"
	zorder="2"
	scale9grid="12|10|3|40"
	onout="controlBar_dpadvertical_onout_action();"
	onover="controlBar_dpadvertical_onover_action();"
	visible="false"
	>

  <layer name="controlBar_dpadbtn_autorotate_on"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_start_autorotation.png"
          onclick="resumeautorotation();
"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          visible="false"
          tooltip="controlBar_dpadautorotateOnTip"
          />
  <layer name="controlBar_dpadbtn_autorotate_off"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_stop_autorotation.png"
          onclick="pauseautorotation();
"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          visible="false"
          tooltip="controlBar_dpadautorotateOffTip"
          />

    <layer name="controlBar_dpadbtn_play_video"
           url="%FIRSTXML%/graphics/crosscornerbar/btn_start_videoplayer.png"
           onclick="videointerface_togglepause();"
           style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
           visible="false"
           tooltip="controlBar_dpadplayVideoTip"
           />
    <layer name="controlBar_dpadbtn_pause_video"
           url="%FIRSTXML%/graphics/crosscornerbar/btn_pause_videoplayer.png"
           onclick="videointerface_togglepause();"
           style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
           visible="false"
           tooltip="controlBar_dpadpauseVideoTip"
           />

  <layer name="controlBar_dpadbtn_autotour_on"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_start_automatic_tour.png"
          onclick="startautotour();
"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          visible="false"
          tooltip="controlBar_dpadautotourOnTip"
          />
  <layer name="controlBar_dpadbtn_autotour_off"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_stop_automatic_tour.png"
          onclick="stopautotour();
"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          visible="false"
          tooltip="controlBar_dpadautotourOffTip"
          />

  <layer name="controlBar_dpadbtn_in"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_zoom_in.png"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          ondown="viewControlZoomIn(false);"
          onup="viewControlZoomStop();
"
          tooltip="controlBar_dpadzoomInTip"
          visible="false"
          devices="desktop"
          />

  <layer name="controlBar_dpadbtn_out"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_zoom_out.png"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          ondown="viewControlZoomOut(false);
"
          onup="viewControlZoomStop();
"
          tooltip="controlBar_dpadzoomOutTip"
          visible="false"
          devices="desktop"
          />
  <layer name="controlBar_dpadzoom_slider_bg"
          url="%FIRSTXML%/graphics/crosscornerbar/slider_bg_vertical.png"
          keep="true"
          align="bottom"
          alpha="0.2"
          visible="false"
          devices="desktop"
          >
    <layer name="controlBar_dpadzoom_slider_grip"
           keep="true"
           url="%FIRSTXML%/graphics/crosscornerbar/slider_grip_vertical.png"
           align="top"
           edge="center"
           ondown="controlBar_dpadzoom_slider_grip_ondown();"
           />
  </layer>

  <layer name="controlBar_dpadbtn_openfs"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_enter_fs.png"
          onclick="enterFullscreen();
"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          tooltip="controlBar_dpadopenFsTip"
          visible="false"
          devices="fullscreensupport"
          />
  <layer name="controlBar_dpadbtn_closefs"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_close_fs.png"
          onclick="exitFullscreen();
"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          visible="false"
          tooltip="controlBar_dpadcloseFsTip"
          devices="fullscreensupport"
          />


  <layer name="controlBar_dpadbtn_enter_vr"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_vr_mode.png"
          onclick="if(scene[get(xml.scene)].full360 AND disableCurrentSceneVrConservation !== true,
    js(accessWebVr(get(xml.scene),get(videoscenestarttime)));
,
    js(accessWebVr(null));
);"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          tooltip="controlBar_dpadenterVRTip"
          visible="false"
          devices="html5"
          />
    <layer name="controlBar_dpadbtn_enter_vr_not"
            url="%FIRSTXML%/graphics/crosscornerbar/btn_vr_mode_off.png"
            style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
            tooltip="controlBar_dpadenterVRNotTip"
            enabled="true"
            capture="false"
            visible="false"
            devices="html5"
            />


  <layer name="controlBar_dpadbtn_ctrlmode_move_to"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_move_to.png"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          tooltip="controlBar_dpadctrlmodeMoveTip"
          onclick="setControlModeMoveTo();
"
          visible="false"
          devices="desktop"
          />
  <layer name="controlBar_dpadbtn_ctrlmode_drag_to"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_drag_to.png"
          style="controlBar_dpadbtn_vertical_style|controlBar_dpadbtn_vertical_style_alpha"
          tooltip="controlBar_dpadctrlmodeDragTip"
          onclick="setControlModeDragTo();
"
          visible="false"
          devices="desktop"
          />


</layer>

  <action name="controlBar_dpadvertical_onout_action">
    set(layer[controlBar_dpadmenu_vertical_bg].alpha, 0.2);
    if (device.fullscreensupport,
      set(layer[controlBar_dpadbtn_openfs].alpha, 0.2);
      set(layer[controlBar_dpadbtn_closefs].alpha, 0.2);
    );
    if (device.desktop,
    set(layer[controlBar_dpadbtn_in].alpha, 0.2);
    set(layer[controlBar_dpadbtn_out].alpha, 0.2);
    set(layer[controlBar_dpadzoom_slider_bg].alpha, 0.2);
    );

    if(layer[controlBar_dpadbtn_enter_vr],
      set(layer[controlBar_dpadbtn_enter_vr].alpha, 0.2);
    );
    set(layer[controlBar_dpadbtn_autotour_off].alpha, 0.2);
    set(layer[controlBar_dpadbtn_autotour_on ].alpha, 0.2);
    set(layer[controlBar_dpadbtn_play_video].alpha, 0.2);
    set(layer[controlBar_dpadbtn_pause_video ].alpha, 0.2);

    set(layer[controlBar_dpadbtn_autorotate_off].alpha, 0.2);
    set(layer[controlBar_dpadbtn_autorotate_on ].alpha, 0.2);
    if (device.desktop,
      set(layer[controlBar_dpadbtn_ctrlmode_drag_to].alpha, 0.2);
      set(layer[controlBar_dpadbtn_ctrlmode_move_to].alpha, 0.2);
    );
  </action>

  <action name="controlBar_dpadvertical_onover_action">
    set(layer[controlBar_dpadmenu_vertical_bg].alpha, 1);
    if (device.fullscreensupport,
      set(layer[controlBar_dpadbtn_openfs].alpha, 1);
      set(layer[controlBar_dpadbtn_closefs].alpha, 1);
    );
    if (device.desktop,
    set(layer[controlBar_dpadbtn_in].alpha, 1);
    set(layer[controlBar_dpadbtn_out].alpha, 1);
    set(layer[controlBar_dpadzoom_slider_bg].alpha, 1);
    );

    if(layer[controlBar_dpadbtn_enter_vr],
      set(layer[controlBar_dpadbtn_enter_vr].alpha, 1);
    );
    set(layer[controlBar_dpadbtn_autotour_off].alpha, 1);
    set(layer[controlBar_dpadbtn_autotour_on ].alpha, 1);
    set(layer[controlBar_dpadbtn_play_video].alpha,1);
    set(layer[controlBar_dpadbtn_pause_video ].alpha, 1);

    set(layer[controlBar_dpadbtn_autorotate_off].alpha, 1);
    set(layer[controlBar_dpadbtn_autorotate_on ].alpha, 1);
    if (device.desktop,
      set(layer[controlBar_dpadbtn_ctrlmode_drag_to].alpha, 1);
      set(layer[controlBar_dpadbtn_ctrlmode_move_to].alpha, 1);
    );
  </action>

  <action name="controlBar_dpadhorizontal_onout_action">
    set(layer[controlBar_dpadmenu_horizontal_bg].alpha, 0.2);


    set(layer[controlBar_dpadbtn_home].alpha, 0.2);
    if (scene.count GT 1,
    set(layer[controlBar_dpadbtn_prev_pano].alpha, 0.2);
    set(layer[controlBar_dpadbtn_next_pano].alpha, 0.2);
    );


    set(layer[controlBar_dpadbtn_show_thumbnails].alpha, 0.2);
    set(layer[controlBar_dpadbtn_hide_thumbnails].alpha, 0.2);
    set(layer[controlBar_dpadbtn_show_hotspots].alpha, 0.2);
    set(layer[controlBar_dpadbtn_hide_hotspots].alpha, 0.2);

    set(layer[controlBar_dpadbtn_display_info].alpha, 0.2);
    set(layer[controlBar_dpadbtn_close_info].alpha, 0.2);
 
  </action>

  <action name="controlBar_dpadhorizontal_onover_action">
    set(layer[controlBar_dpadmenu_horizontal_bg].alpha, 1);


    set(layer[controlBar_dpadbtn_home].alpha, 1);
    if (scene.count GT 1,
    set(layer[controlBar_dpadbtn_prev_pano].alpha, 1);
    set(layer[controlBar_dpadbtn_next_pano].alpha, 1);
    );


    set(layer[controlBar_dpadbtn_show_thumbnails].alpha, 1);
    set(layer[controlBar_dpadbtn_hide_thumbnails].alpha, 1);
    set(layer[controlBar_dpadbtn_show_hotspots].alpha, 1);
    set(layer[controlBar_dpadbtn_hide_hotspots].alpha, 1);

    set(layer[controlBar_dpadbtn_display_info].alpha, 1);
    set(layer[controlBar_dpadbtn_close_info].alpha, 1);

  </action>

  <style name="controlBar_dpadbtn_horizontal_style"
         keep="true"
         align="left"
         onhover="controlBar_dpadshowHorizontalMenuTooltip();"
         onout="hideTooltip();"
               crop="0| 0|30|30"
         onovercrop="0|30|30|30"
         ondowncrop="0|60|30|30"
         y="0"
         />
<style name="controlBar_dpadbtn_horizontal_style_alpha"
	alpha="1.0"
	devices="tablet.or.mobile"
	/>
<style name="controlBar_dpadbtn_horizontal_style_alpha"
	alpha="0.2"
	devices="desktop"
	/>

  <layer name="controlBar_dpadmenu_horizontal_bg"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_bg_horizontal.png"
          keep="true"
          align="bottomleft"
          x="118"
          y="64"
          edge="left"
          zorder="1"
          scale9grid="10|12|40|3"
          style="controlBar_dpadmenu_bg_alpha"
          visible="false"
          />

  <layer name="controlBar_dpadmenu_horizontal_bg_border"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_bg_border_horizontal.png"
          keep="true"
          align="bottomleft"
          x="118"
          y="64"
          edge="left"
          zorder="2"
          scale9grid="10|12|40|3"
          onout="controlBar_dpadhorizontal_onout_action();"
          onover="controlBar_dpadhorizontal_onover_action();"
          visible="false"
          >
    <layer name="controlBar_dpadbtn_home"
           url="%FIRSTXML%/graphics/crosscornerbar/btn_home.png"
           onclick="controlBar_dpadbtn_home_action();"
           style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
           tooltip="controlBar_dpadhomeTip"
           visible="false"
           />

    <layer name="controlBar_dpadbtn_prev_pano"
            url="%FIRSTXML%/graphics/crosscornerbar/btn_previous_scene.png"
            onclick="loadPreviousScene();
"
            style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
            tooltip="controlBar_dpadprevSceneTip"
            visible="false"
            />
    <layer name="controlBar_dpadbtn_next_pano"
            url="%FIRSTXML%/graphics/crosscornerbar/btn_next_scene.png"
            onclick="loadNextScene();
"
            style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
            tooltip="controlBar_dpadnextSceneTip"
            visible="false"
            />


  <layer name="controlBar_dpadbtn_hide_thumbnails"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_hide_thumbnails.png"
          style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
          onclick="hideTourThumbnails();
"
          tooltip="controlBar_dpadhideThumbnailsTip"
          visible="false"
          />
  <layer name="controlBar_dpadbtn_show_thumbnails"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_show_thumbnails.png"
          style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
          onclick="showTourThumbnails();
"
          tooltip="controlBar_dpadshowThumbnailsTip"
          visible="false"
          />

  <layer name="controlBar_dpadbtn_hide_hotspots"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_hide_show_hotspots.png"
          style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
          onclick="hideHotspots();
"
          tooltip="controlBar_dpadhideSpotsTip"
          visible="false"
          />
  <layer name="controlBar_dpadbtn_show_hotspots"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_hide_show_hotspots.png"
          style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
          onclick="showHotspots();
"
          tooltip="controlBar_dpadshowSpotsTip"
          visible="false"
          />




    <layer name="controlBar_dpadbtn_display_info"
           url="%FIRSTXML%/graphics/crosscornerbar/btn_info.png"
           onclick="showTourInfo();
"
           style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
           tooltip="controlBar_dpaddisplayInfoTip"
           visible="false"
           />
    <layer name="controlBar_dpadbtn_close_info"
           url="%FIRSTXML%/graphics/crosscornerbar/btn_info.png"
           onclick="hideTourInfo();
"
           style="controlBar_dpadbtn_horizontal_style|controlBar_dpadbtn_horizontal_style_alpha"
           visible="false"
           tooltip="controlBar_dpadhideInfoTip"
           />

  </layer>


	
	<style name="controlBar_dpadbtn_navigation_style"
		keep="true"
		onhover="controlBar_dpadshowVerticalMenuTooltip();"
		onout="hideTooltip();"
		crop="0|0|30|30"
		onovercrop="0|30|30|30"
		ondowncrop="0|60|30|30"
	/>
	<style name="controlBar_dpadbtn_navigation_style_alpha"
		alpha="1.0"
		devices="tablet.or.mobile"
	/>
	<style name="controlBar_dpadbtn_navigation_style_alpha"
		alpha="0.2"
		devices="desktop"
	/>
	<style name="controlBar_dpadbtn_navigation_style_showctrl"
		keep="true"
		onout="hideTooltip();set(alpha, 0.5);"
		onover="set(alpha, 1);"
	/>
	
	<layer name="controlBar_dpadnavigation_bg"
		url="%FIRSTXML%/graphics/crosscornerbar/btn_bg_move.png"
		align="bottomleft"
		x="10"
		y="10"
		keep="true"
		capture="false"
		zorder="1"
		style="controlBar_dpadmenu_bg_alpha"
		visible="false"
		/>

  <layer name="controlBar_dpadnavigation_bg_border"
          url="%FIRSTXML%/graphics/crosscornerbar/btn_bg_border_move.png"
          keep="true"
          align="bottomleft"
          x="10"
          y="10"
          capture="false"
          zorder="2"
          onout="controlBar_dpadnav_onout_action();"
          onover="controlBar_dpadnav_onover_action();"
          visible="false"
          >

	<layer name="controlBar_dpadbtn_hidecontrols"
		url="%FIRSTXML%/graphics/crosscornerbar/btn_hide_controls.png"
		style="controlBar_dpadbtn_navigation_style"
		onclick="controlBar_dpadhideMenuControls();hideTourControls();
"
		edge="center"
		align="center"
		tooltip="controlBar_dpadhideControlsTip"
		visible="false"
		alpha="1.0"
		/>
	<layer name="controlBar_dpadbtn_showcontrols"
		onclick="controlBar_dpadshowMenuControls();showTourControls();
"
		url="%FIRSTXML%/graphics/crosscornerbar/btn_show_controls.png"
		style="controlBar_dpadbtn_navigation_style|controlBar_dpadbtn_navigation_style_showctrl"
		align="center"
		edge="center"
		visible="false"
		alpha="0.5"
		tooltip="controlBar_dpaddisplayControlsTip"
		/>
	
</layer>

    <action name="controlBar_dpadbtn_home_action">
      hideTooltip();lookto(get(panoview.h),get(panoview.v),get(panoview.fov),smooth(100,20,50));
      if(scene[get(xml.scene)].video,
        plugin[get(videointerface_video)].seek(0);
        ifnot(plugin[get(videointerface_video)].ispaused,
          plugin[get(videointerface_video)].play();
        );
      );
    </action>

  <action name="controlBar_dpadnav_onout_action">
    set(layer[controlBar_dpadnavigation_bg].alpha, 0.2);
  </action>

  <action name="controlBar_dpadnav_onover_action">
    set(layer[controlBar_dpadnavigation_bg].alpha, 1);
  </action>



	<events name="controlBar_dpadhideshowthumbnailsevent" hidetourthumbnails="controlBar_dpadupdateHideShowThumbnailsButtons();" showtourthumbnails="controlBar_dpadupdateHideShowThumbnailsButtons();" keep="true"/>
	<action name="controlBar_dpadHideHideShowThumbnailsButtons">
		set(layer[controlBar_dpadbtn_show_thumbnails].visible, false);
		set(layer[controlBar_dpadbtn_hide_thumbnails].visible, false);
	</action>
	<action name="controlBar_dpadShowHideShowThumbnailsButtons">
		if (tour_displaythumbnails,
			set(layer[controlBar_dpadbtn_hide_thumbnails].visible, true);
			set(layer[controlBar_dpadbtn_show_thumbnails].visible, false);
		,
			set(layer[controlBar_dpadbtn_show_thumbnails].visible, true);
			set(layer[controlBar_dpadbtn_hide_thumbnails].visible, false);
		);
	</action>
	<action name="controlBar_dpadupdateHideShowThumbnailsButtons">
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowHideShowThumbnailsButtons();
		,
			controlBar_dpadHideHideShowThumbnailsButtons();
		);
	</action>

	<events name="controlBar_dpadhotspotsdisplayevents"
		hotspots_visibility_changed="controlBar_dpadupdateHideShowHotspotsButtons"
		keep="true"/>
	<action name="controlBar_dpadHideHideShowHotspotsButtons">
		set(layer[controlBar_dpadbtn_show_hotspots].visible, false);
		set(layer[controlBar_dpadbtn_hide_hotspots].visible, false);
	</action>
	<action name="controlBar_dpadShowHideShowHotspotsButtons">
		if (tour_displayspots,
			set(layer[controlBar_dpadbtn_hide_hotspots].visible, true);
			set(layer[controlBar_dpadbtn_show_hotspots].visible, false);
		,
			set(layer[controlBar_dpadbtn_show_hotspots].visible, true);
			set(layer[controlBar_dpadbtn_hide_hotspots].visible, false);
		);
	</action>
	<action name="controlBar_dpadupdateHideShowHotspotsButtons">
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowHideShowHotspotsButtons();
		,
			controlBar_dpadHideHideShowHotspotsButtons();
		);
	</action>
	
	<events name="controlBar_dpadAutorotationEvents"
		onstartautorotation="controlBar_dpadupdateAutorotationButtons();"
		onresumeautorotation="controlBar_dpadupdateAutorotationButtons();"
		onstopautorotation="controlBar_dpadupdateAutorotationButtons();"
		onpauseautorotation="controlBar_dpadupdateAutorotationButtons();"
		keep="true"/>
	<action name="controlBar_dpadHideAutorotationButtons">
		set(layer[controlBar_dpadbtn_autorotate_off].visible, false);
		set(layer[controlBar_dpadbtn_autorotate_on].visible , false);
	</action>
	<action name="controlBar_dpadShowAutorotationButtons">
		if(autorotate.enabled == false,
			set(layer[controlBar_dpadbtn_autorotate_off].visible, false);
			set(layer[controlBar_dpadbtn_autorotate_on].visible , true);
		,
			set(layer[controlBar_dpadbtn_autorotate_off].visible, true);
			set(layer[controlBar_dpadbtn_autorotate_on].visible , false);
		);
	</action>
	<action name="controlBar_dpadupdateAutorotationButtons">
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowAutorotationButtons();
		,
			controlBar_dpadHideAutorotationButtons();
		);
	</action>


    <events name="controlBar_dpadhideshowvideoplayerevent" onplayvideointerface="controlBar_dpadupdateHideShowVideoplayerButtons();" onpausevideointerface="controlBar_dpadupdateHideShowVideoplayerButtons();" keep="true"/>
    <action name="controlBar_dpadHideHideShowVideoplayerButtons">
      if(controlBar_dpadverticalheight GT 0,
        if(crosscornerbarverticalheightwithoutvideo LE 0,
          set(layer[controlBar_dpadmenu_vertical_bg].visible, false);
          set(layer[controlBar_dpadmenu_vertical_bg_border].visible,false);
        );
      );
      set(layer[controlBar_dpadbtn_play_video].visible, false);
      set(layer[controlBar_dpadbtn_pause_video].visible, false);
      set(layer[controlBar_dpadmenu_vertical_bg].height, get(controlBar_dpadverticalheightwithoutvideo));
      set(layer[controlBar_dpadmenu_vertical_bg_border].height, get(controlBar_dpadverticalheightwithoutvideo));
    </action>
    <action name="controlBar_dpadShowHideShowVideoplayerButtons">
      if(controlBar_dpad_use_videoplayer_interface,
        if (plugin[get(videointerface_video)],
        if(crosscornerbarverticalheightwithoutvideo LE 0,
          set(layer[controlBar_dpadmenu_vertical_bg].visible, true);
          set(layer[controlBar_dpadmenu_vertical_bg_border].visible, true);
        );
        if (plugin[get(videointerface_video)].ispaused,
          if(controlBar_dpadverticalheight GT 0,
            set(layer[controlBar_dpadmenu_vertical_bg].height, get(controlBar_dpadverticalheight));
            set(layer[controlBar_dpadmenu_vertical_bg_border].height, get(controlBar_dpadverticalheight));
          ,
            set(layer[controlBar_dpadmenu_vertical_bg].height, get(controlBar_dpadverticalheightwithoutvideo));
            set(layer[controlBar_dpadmenu_vertical_bg_border].height, get(controlBar_dpadverticalheightwithoutvideo));
          );
          set(layer[controlBar_dpadbtn_play_video].visible, true);
          set(layer[controlBar_dpadbtn_pause_video].visible, false);
        ,
          if(controlBar_dpadverticalheight GT 0,
            set(layer[controlBar_dpadmenu_vertical_bg].height, get(controlBar_dpadverticalheight));
            set(layer[controlBar_dpadmenu_vertical_bg_border].height, get(controlBar_dpadverticalheight));
          ,
            set(layer[controlBar_dpadmenu_vertical_bg].height, get(controlBar_dpadverticalheightwithoutvideo));
            set(layer[controlBar_dpadmenu_vertical_bg_border].height, get(controlBar_dpadverticalheightwithoutvideo));
          );
          set(layer[controlBar_dpadbtn_play_video].visible, false);
          set(layer[controlBar_dpadbtn_pause_video].visible, true);
        ););
      ,
        controlBar_dpadHideHideShowVideoplayerButtons();
      );
    </action>
    <action name="controlBar_dpadupdateHideShowVideoplayerButtons">
      if (controlBar_dpadIsOpened,
        controlBar_dpadShowHideShowVideoplayerButtons();
      ,
        controlBar_dpadHideHideShowVideoplayerButtons();
      );
    </action>
    
	<events name="controlBar_dpadAutotourEvents"
		onstartautotour="controlBar_dpadupdateAutotourButtons();"
		onstopautotour="controlBar_dpadupdateAutotourButtons();"
		keep="true"/>
	<action name="controlBar_dpadHideAutotourButtons">
		set(layer[controlBar_dpadbtn_autotour_off].visible, false);
		set(layer[controlBar_dpadbtn_autotour_on].visible , false);
	</action>
	<action name="controlBar_dpadShowAutotourButtons">
		if (tour_autotourenabled == false,
			set(layer[controlBar_dpadbtn_autotour_off].visible, false);
			set(layer[controlBar_dpadbtn_autotour_on].visible , true);
		,
			set(layer[controlBar_dpadbtn_autotour_off].visible, true);
			set(layer[controlBar_dpadbtn_autotour_on].visible , false);
		);
	</action>
	<action name="controlBar_dpadupdateAutotourButtons">
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowAutotourButtons();
		,
			controlBar_dpadHideAutotourButtons();
		);
	</action>
	

	<events name="controlBar_dpadcontrolmodechangedevent" oncontrolmodechanged="if (controlBar_dpadControlModeButtonsActivated,controlBar_dpadupdateControlModeButtons(););" onxmlcomplete="set(controlBar_dpadControlModeButtonsActivated, true);" keep="true"/>
	<action name="controlBar_dpadHideControlModeButtons">
		set(layer[controlBar_dpadbtn_ctrlmode_move_to].visible, false);
		set(layer[controlBar_dpadbtn_ctrlmode_drag_to].visible, false);
	</action>
	<action name="controlBar_dpadShowControlModeButtons">
		if (tour_controlmodemousetype == "moveto",
			set(layer[controlBar_dpadbtn_ctrlmode_drag_to].visible, true);
			set(layer[controlBar_dpadbtn_ctrlmode_move_to].visible, false);
		,
			set(layer[controlBar_dpadbtn_ctrlmode_move_to].visible, true);
			set(layer[controlBar_dpadbtn_ctrlmode_drag_to].visible, false);
		);
	</action>
	<action name="controlBar_dpadupdateControlModeButtons">
	if (device.desktop,
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowControlModeButtons();
		,
			controlBar_dpadHideControlModeButtons();
		);
	,
		controlBar_dpadHideControlModeButtons();
	);
	</action>
	
  <action name="controlBar_dpadzoom_slider_grip_dragging">
    if (pressed,
      sub(dy, mouse.stagey, drag_stagey); 
      add(newy, drag_currenty, dy); 

      if(newy LT 0, set(newy, 0) );
      if(newy GT layer[controlBar_dpadzoom_slider_bg].pixelheight, copy(newy, layer[controlBar_dpadzoom_slider_bg].pixelheight));
      copy(y, newy);

      div(val, newy, layer[controlBar_dpadzoom_slider_bg].pixelheight);

      sub(fovrange, view.fovmax, view.fovmin);
      mul(newfov  , val, fovrange);
      add(newfov  , view.fovmin);
      set(view.fov, get(newfov));

      delayedcall(0, controlBar_dpadzoom_slider_grip_dragging());
    );
  </action>
  <action name="controlBar_dpadzoom_slider_grip_ondown">
    copy(drag_currenty, y);
    copy(drag_stagey, mouse.stagey);
    controlBar_dpadzoom_slider_grip_dragging();
  </action>
  <events name="controlBar_dpadzoom_slider_events" keep="true" onviewchanged="controlBar_dpadzoom_slider_update();" />
  <action name="controlBar_dpadzoom_slider_update">
    if (device.desktop,
    ifnot (layer[controlBar_dpadzoom_slider_grip].pressed,
      sub(val, view.fov, view.fovmin);
      sub(fovrange, view.fovmax, view.fovmin);
      div(val, fovrange);
      mul(newy, val, layer[controlBar_dpadzoom_slider_bg].pixelheight);
      set(layer[controlBar_dpadzoom_slider_grip].y, get(newy));
    );
    );
  </action>

	<events name="controlBar_dpadmenufullscreenchangeevent"
		onenterfullscreen="controlBar_dpadupdateFullscreenButtons();"
		onexitfullscreen="controlBar_dpadupdateFullscreenButtons();"
		keep="true"/>
	<action name="controlBar_dpadHideFullscreenButtons">
		set(layer[controlBar_dpadbtn_openfs].visible , false);
		set(layer[controlBar_dpadbtn_closefs].visible, false);
	</action>
	<action name="controlBar_dpadShowFullscreenButtons">
		if (device.fullscreensupport,
			if(tour_fullscreen,
				set(layer[controlBar_dpadbtn_openfs].visible , false);
				set(layer[controlBar_dpadbtn_closefs].visible, true);
			,
				set(layer[controlBar_dpadbtn_openfs].visible ,true);
				set(layer[controlBar_dpadbtn_closefs].visible,false);
			);
		,
			controlBar_dpadHideFullscreenButtons();
		);
	</action>
	<action name="controlBar_dpadupdateFullscreenButtons">
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowFullscreenButtons();
		,
			controlBar_dpadHideFullscreenButtons();
		);
	</action>
	

<events name="controlBar_dpadvravailableevent"
		onvravailable="controlBar_dpadupdateVrButtonsAvailability();"
		onvrunavailable="controlBar_dpadupdateVrButtonsAvailability();"
		keep="true" devices="html5" />
	<krpano controlBar_dpadmenuvravailable="false" />
	<action name="controlBar_dpadupdateVrButtonsAvailability">
		if (tour_vrdevices,
			set(controlBar_dpadmenuvravailable, true);
		,
			set(controlBar_dpadmenuvravailable, false);
		);
		controlBar_dpadupdateVrButtons();
	</action>
	<action name="controlBar_dpadHideVrButtons">
		set(layer[controlBar_dpadbtn_enter_vr].visible, false);
		if('%1' == 'true' AND plugin[ptpvrmode],
			set(layer[controlBar_dpadbtn_enter_vr_not].visible, true);
		,
			set(layer[controlBar_dpadbtn_enter_vr_not].visible, false);
		);
	</action>
	<action name="controlBar_dpadShowVrButtons">
		if (controlBar_dpadmenuvravailable,
			set(layer[controlBar_dpadbtn_enter_vr].visible, true);
			set(layer[controlBar_dpadbtn_enter_vr_not].visible, false);
		,
			controlBar_dpadHideVrButtons(true);
		);
	</action>
	<action name="controlBar_dpadupdateVrButtons">
	if (tour_vrdevices,
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowVrButtons();
		,
			controlBar_dpadHideVrButtons();
		);
	,
		if (controlBar_dpadIsOpened,
			controlBar_dpadHideVrButtons(true);
		,
			controlBar_dpadHideVrButtons();
		);
	);
	</action>



<action name="controlBar_dpadhideMenuControls">
		set(controlBar_dpadIsOpened, false);
		set(layer[controlBar_dpadnavigation_bg].visible, false);
		
		
		set(layer[controlBar_dpadnavigation_bg_border].visible, true);
		tween(layer[controlBar_dpadnavigation_bg_border].alpha, 0.5, 1);
		
		
		if(controlBar_dpadverticalheight GT 0,
			set(layer[controlBar_dpadmenu_vertical_bg].visible, false);
				set(layer[controlBar_dpadbtn_in].visible, false);
				set(layer[controlBar_dpadbtn_out].visible, false);
					set(layer[controlBar_dpadzoom_slider_bg].visible, false);


				controlBar_dpadupdateAutorotationButtons();

				controlBar_dpadupdateAutotourButtons();
				controlBar_dpadupdateHideShowVideoplayerButtons();
				controlBar_dpadupdateVrButtons();

				controlBar_dpadupdateFullscreenButtons();
				controlBar_dpadupdateControlModeButtons();
			tween(layer[controlBar_dpadmenu_vertical_bg_border].alpha , 0, 1);
			tween(layer[controlBar_dpadmenu_vertical_bg_border].height , 0, 1, easeOutQuad, set(layer[controlBar_dpadmenu_vertical_bg_border].visible, false));
		);
		
		
		if(controlBar_dpadhorizontalwidth != 0,
			set(layer[controlBar_dpadmenu_horizontal_bg].visible, false);


				set(layer[controlBar_dpadbtn_home].visible, false);
				if (scene.count GT 1,
					set(layer[controlBar_dpadbtn_prev_pano].visible, false);
					set(layer[controlBar_dpadbtn_next_pano].visible, false);
				);


				controlBar_dpadupdateHideShowHotspotsButtons();
				controlBar_dpadupdateHideShowThumbnailsButtons();

				controlBar_dpadupdateInfoButtons();

			tween(layer[controlBar_dpadmenu_horizontal_bg_border].alpha , 0, 1);
			tween(layer[controlBar_dpadmenu_horizontal_bg_border].width, 0, 1, easeOutQuad, set(layer[controlBar_dpadmenu_horizontal_bg_border].visible, false));
		);
		set(layer[controlBar_dpadbtn_showcontrols].visible, true);
		set(layer[controlBar_dpadbtn_hidecontrols].visible, false);
	</action>
	
	<action name="controlBar_dpadshowMenuControls">
	set(controlBar_dpadIsOpened, true);
    set(layer[controlBar_dpadbtn_showcontrols].visible, false);
    set(layer[controlBar_dpadbtn_hidecontrols].visible, true);
    set(layer[controlBar_dpadnavigation_bg].visible, true);


    set(layer[controlBar_dpadnavigation_bg_border].visible, true);
    tween(layer[controlBar_dpadnavigation_bg_border].alpha, 1, 1);

    
    if(controlBar_dpadverticalheight GT 0,
      set(layer[controlBar_dpadmenu_vertical_bg_border].visible, true);
      tween(layer[controlBar_dpadmenu_vertical_bg_border].alpha, 1, 1);
      tween(layer[controlBar_dpadmenu_vertical_bg_border].height, get(controlBar_dpadverticalheight), 1, easeOutQuad,
        set(layer[controlBar_dpadmenu_vertical_bg].visible, true);
        controlBar_dpadupdateFullscreenButtons();
        controlBar_dpadupdateAutorotationButtons();

        controlBar_dpadupdateAutotourButtons();
        controlBar_dpadupdateHideShowVideoplayerButtons();
        controlBar_dpadupdateVrButtons();

        if (device.desktop,
        set(layer[controlBar_dpadbtn_in].visible, true);
        set(layer[controlBar_dpadbtn_out].visible, true);
        set(layer[controlBar_dpadzoom_slider_bg].visible, true);
        );


      );
    );

    
    if(controlBar_dpadhorizontalwidth != 0,
      set(layer[controlBar_dpadmenu_horizontal_bg_border].visible, true);
      tween(layer[controlBar_dpadmenu_horizontal_bg_border].alpha, 1, 1);
      tween(layer[controlBar_dpadmenu_horizontal_bg_border].width, get(controlBar_dpadhorizontalwidth), 1, easeOutQuad,
        set(layer[controlBar_dpadmenu_horizontal_bg].visible, true);


      set(layer[controlBar_dpadbtn_home].visible, true);
        if (scene.count GT 1,
          set(layer[controlBar_dpadbtn_prev_pano].visible, true);
          set(layer[controlBar_dpadbtn_next_pano].visible, true);
        );
        controlBar_dpadupdateControlModeButtons();


        controlBar_dpadupdateHideShowThumbnailsButtons();
        controlBar_dpadupdateHideShowHotspotsButtons();



        controlBar_dpadupdateInfoButtons();

      );
    );
  </action>


	<events name="controlBar_dpaddisplayinfochangeevent"
		onhidetourinfo="controlBar_dpadupdateInfoButtons();"
		onshowtourinfo="controlBar_dpadupdateInfoButtons();"
		keep="true"/>
	<action name="controlBar_dpadHideInfoButtons">
		set(layer[controlBar_dpadbtn_display_info].visible, false);
		set(layer[controlBar_dpadbtn_close_info].visible, false);
	</action>
	<action name="controlBar_dpadShowInfoButtons">
		if (tour_displayinfo,
			set(layer[controlBar_dpadbtn_close_info].visible, true);
			set(layer[controlBar_dpadbtn_display_info].visible, false);
		,
			set(layer[controlBar_dpadbtn_display_info].visible, true);
			set(layer[controlBar_dpadbtn_close_info].visible, false);
		);
	</action>
	<action name="controlBar_dpadupdateInfoButtons">
		if (controlBar_dpadIsOpened,
			controlBar_dpadShowInfoButtons();
		,
			controlBar_dpadHideInfoButtons();
		);
	</action>
	

  <action name="controlBar_dpadshowHorizontalMenuTooltip">
    if (tooltip !== null, showTooltip('plugin', controlBar_dpadhorizMenuTooltipStyle, bottom););
  </action>
  <action name="controlBar_dpadshowVerticalMenuTooltip">
    if (tooltip !== null, showTooltip('plugin', controlBar_dpadverticalMenuTooltipStyle, left););
  </action>

  <layer name="controlBar_dpadhorizMenuTooltipStyle"
	keep="true"
	enabled="false"
	capture="false"
	type="text"
	align="center"
	bg="true"
	bgcolor="0x462c72"
	bgalpha="1"
	bgborder="2.0 0xbafefd 1"
	mergedalpha="false"
	css="color:#bafefd;font-family:Times New Roman;font-weight:bold;font-size:14px;text-align:left;"
	interactivecontent="false"
	zorder="0"
	padding="2"
	xoffset="0"
	visible="false"
	html=""
	edge="bottom"
	yoffset="-10"
  />
  <layer name="controlBar_dpadverticalMenuTooltipStyle"
	keep="true"
	enabled="false"
	capture="false"
	type="text"
	align="center"
	bg="true"
	bgcolor="0x462c72"
	bgalpha="1"
	bgborder="2.0 0xbafefd 1"
	mergedalpha="false"
	css="color:#bafefd;font-family:Times New Roman;font-weight:bold;font-size:14px;text-align:left;"
	interactivecontent="false"
	zorder="0"
	padding="2"
	yoffset="0"
	visible="false"
	html=""
	edge="left"
	xoffset="10"
  />







<!-- ********** -->
<!-- Force Landscape on Mobile -->
<!-- id : ForceLandscapeMobilePlugin -->
<!-- ********** -->

	<events name="mobileorientation_events" devices="mobile" keep="true" onresize="mobileorientation_portrait_mode_check();"/>

	<action name="mobileorientation_portrait_mode_check" device="mobile">
		div(aspect, stagewidth, stageheight);
		if(aspect != lastaspect OR '%1' == 'true',
			copy(lastaspect, aspect);
			if(stagewidth GT stageheight,
				tween(layer[mobileorientation_rotate_device_required].alpha, 0.0, 0.0);
			,
				tween(layer[mobileorientation_rotate_device_required].alpha, 1.0);
				delayedcall(3.0, tween(layer[mobileorientation_rotate_device_required].alpha, 0.0, 1.0););
			);
		);
	</action>	

	<layer name="mobileorientation_rotate_device_required" keep="true" devices="mobile" 
		url="%FIRSTXML%/graphics/rotate_device.png" width="80%" height="prop"
		align="center" edge="center"
		autoalpha="true" alpha="0.0"
		enabled="false"
		/>	
<action name="viewControlZoomIn">
	if(%1,
		if(%2,
			if(%2 LT view.fovmin,
				zoomto(get(view.fovmin));
			,
				if(%2 LT view.fov,
					zoomto(%2);
				);
			);
		,
			set(fov_moveforce, -1);
			delayedcall(0.1, viewControlZoomStop());
		);
	,
		set(fov_moveforce, -1);
	);
</action>
<action name="viewControlZoomOut">
	if(%1,
		if(%2,
			if(%2 GT view.fovmax,
				zoomto(get(view.fovmax));
			,
				if(%2 GT view.fov,
					zoomto(%2);
				);
			);
		,
			set(fov_moveforce, +1);
			delayedcall(0.1, viewControlZoomStop());
		);
	,
		set(fov_moveforce, +1);
	);
</action>
<action name="viewControlZoomStop">
	set(fov_moveforce, 0);
</action>

  <!-- Hide / Show Controls -->
  <action name="hideTourControls">set(tour_displaycontrols, false);events.dispatch(hidetourcontrols);</action>
  <action name="showTourControls">set(tour_displaycontrols, true); events.dispatch(showtourcontrols);</action>


	<!-- WebVR plugin for VR availability tests -->

	<plugin name="ptpvrmode" devices="html5" keep="true"
		url="%FIRSTXML%/graphics/webvr.js"
		mobilevr_support="true"
		mobilevr_fake_support="false"
		vr_cursor=""
		vr_cursor_enabled="false"
		onavailable="delayedcall(1, checkVrAvailability(););"
		onunavailable="checkVrUnavailable();"
		/>
	<action name="checkVrAvailability">
		if(plugin[ptpvrmode],
			if (plugin[ptpvrmode].isavailable,
				set(tour_vrdevices, true);
				events.dispatch(onvravailable);
			,
				set(tour_vrdevices, false);
			);
		,
			checkVrUnavailable();
		);
	</action>
	<action name="checkVrUnavailable">
		set(tour_vrdevices, false);
		events.dispatch(onvrunavailable);
	</action>
  <!-- Hide / Show Thumbnails -->
  <action name="hideTourThumbnails">set(tour_displaythumbnails, false);events.dispatch(hidetourthumbnails);</action>
  <action name="showTourThumbnails">set(tour_displaythumbnails, true); events.dispatch(showtourthumbnails);</action>


  <!-- Tour Information -->
  <action name="hideTourInfo">set(tour_displayinfo, false);events.dispatch(onhidetourinfo);</action>
  <action name="showTourInfo">set(tour_displayinfo, true); events.dispatch(onshowtourinfo);</action>


  <!-- Fullscreen Management -->
  <action name="exitFullScreen" devices="fullscreensupport">set(tour_fullscreen,false);set(fullscreen,false);</action>
  <action name="enterFullScreen" devices="fullscreensupport">set(tour_fullscreen,true);set(fullscreen,true);</action>
  <action name="switchFullScreen">if(tour_fullscreen,exitFullScreen();,enterFullScreen(););</action>

  
  <events name="krpanoExitFullscreenEvent"
    onexitfullscreen="if(tour_fullscreen,exitFullScreenChangeEvent(););"
    keep="true" />

  <action name="exitFullScreenChangeEvent" devices="fullscreensupport">set(tour_fullscreen,false);events.dispatch(onexitfullscreen);</action>

</krpano>